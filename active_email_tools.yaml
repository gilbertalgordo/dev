import google.generativeai as genai
import os

# Configure your API Key
genai.configure(api_key="YOUR_GEMINI_API_KEY")
model = genai.GenerativeModel('gemini-1.5-flash')

def analyze_email(subject, body):
    prompt = f"""
    Act as an AI Executive Assistant. 
    Analyze the following email and return a JSON response.
    
    Email Subject: {subject}
    Email Body: {body}
    
    Return JSON with:
    - "category": (Support, Meeting, Personal, Spam)
    - "priority": (1-5)
    - "action_required": (True/False)
    - "suggested_reply": "A professional draft"
    """
    
    response = model.generate_content(prompt)
    return response.text

# Example Usage
email_content = "Hi, can we reschedule our 1:1 to Thursday at 3 PM?"
analysis = analyze_email("Meeting Update", email_content)
print(analysis)



import os
from typing import TypedDict, Annotated, List
from langgraph.graph import StateGraph, END
from googleapiclient.discovery import build
from langchain_google_genai import ChatGoogleGenerativeAI

# 1. Define the State
class EmailState(TypedDict):
    email_id: str
    content: str
    category: str
    draft: str
    requires_approval: bool

# 2. Initialize Models & Tools
llm = ChatGoogleGenerativeAI(model="gemini-1.5-pro", temperature=0)

def triage_node(state: EmailState):
    """Categorizes the email and decides if it's worth a reply."""
    prompt = f"Triage this email: {state['content']}. Categories: URGENT, INFORMATIONAL, SPAM."
    prediction = llm.invoke(prompt)
    
    # Kaizen Logic: Only process URGENT/INFORMATIONAL
    return {"category": prediction.content, "requires_approval": True}

def draft_node(state: EmailState):
    """Generates a high-fidelity HD response draft."""
    prompt = f"Draft a concise, professional reply to: {state['content']}"
    draft = llm.invoke(prompt)
    return {"draft": draft.content}

# 3. Build the Logic Graph
workflow = StateGraph(EmailState)

workflow.add_node("triage", triage_node)
workflow.add_node("draft_reply", draft_node)

workflow.set_entry_point("triage")
workflow.add_edge("triage", "draft_reply")
workflow.add_edge("draft_reply", END)

app = workflow.compile()
