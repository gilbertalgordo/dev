import os
import time
import platform
import subprocess

class NetworkAI:
    def __init__(self, target_host="8.8.8.8"):
        self.target_host = target_host
        self.os_type = platform.system()

    def check_connection(self):
        """Pings the target host to verify internet access."""
        # -n for Windows, -c for Linux/Mac
        param = "-n" if self.os_type == "Windows" else "-c"
        command = ["ping", param, "1", self.target_host]
        
        return subprocess.call(command, stdout=subprocess.DEVNULL, stderr=subprocess.STDOUT) == 0

    def activate_internet(self):
        """Attempts to reset network adapters based on OS."""
        print("[HUD] ALERT: Connection Lost. Initializing Activation Sequence...")
        
        if self.os_type == "Windows":
            # Requires Administrative privileges
            os.system('netsh interface set interface "Wi-Fi" admin=disable')
            time.sleep(2)
            os.system('netsh interface set interface "Wi-Fi" admin=enable')
        else:
            # Linux/macOS (using nmcli)
            os.system('nmcli networking off')
            time.sleep(2)
            os.system('nmcli networking on')
            
        print("[HUD] SUCCESS: Reconnection Signal Sent.")

    def monitor(self, interval=30):
        """Continuous monitoring loop."""
        print(f"[HUD] AI Network Guard Active. Target: {self.target_host}")
        while True:
            if not self.check_connection():
                self.activate_internet()
            else:
                # Normal state
                print("[HUD] Status: Online", end="\r")
            time.sleep(interval)

if __name__ == "__main__":
    ai_guard = NetworkAI()
    ai_guard.monitor()



import time
import asyncio
import psutil
import subprocess
import platform
from datetime import datetime

class AdvancedNetAI:
    def __init__(self):
        self.stats = {"reconnections": 0, "last_fail": None}
        self.os = platform.system()

    def log_hud(self, message, status="INFO"):
        """Outputs data in a HUD-inspired format."""
        timestamp = datetime.now().strftime("%H:%M:%S")
        print(f"║ [{timestamp}] [{status}] >> {message}")

    async def ping_check(self, host="1.1.1.1"):
        """Performs a non-blocking latency check."""
        param = "-n" if self.os == "Windows" else "-c"
        process = await asyncio.create_subprocess_exec(
            "ping", param, "1", host,
            stdout=asyncio.subprocess.PIPE,
            stderr=asyncio.subprocess.PIPE
        )
        stdout, _ = await process.communicate()
        return process.returncode == 0

    def get_signal_metrics(self):
        """Analyzes hardware interface throughput."""
        addrs = psutil.net_if_addrs()
        stats = psutil.net_if_stats()
        return {name: ("UP" if stats[name].isup else "DOWN") for name in addrs}

    async def force_activation(self):
        """Hard-resets the network stack via system calls."""
        self.log_hud("CRITICAL: Network drop detected. Initiating Layer 1 Reset...", "WARN")
        
        if self.os == "Windows":
            # Flushes DNS and resets the IP stack
            commands = [
                'ipconfig /release',
                'ipconfig /renew',
                'ipconfig /flushdns'
            ]
        else:
            # Restarts Network Manager on Linux/macOS
            commands = ['nmcli networking off', 'nmcli networking on']

        for cmd in commands:
            subprocess.run(cmd, shell=True, capture_output=True)
            await asyncio.sleep(1)
            
        self.stats["reconnections"] += 1
        self.log_hud(f"Activation Complete. Total Re-routes: {self.stats['reconnections']}", "SUCCESS")

    async def run_core(self):
        print("╔════════════════════════════════════════════════════════════╗")
        print("║ AI NETWORK AUTOMATION CORE v2.0 | SYSTEM: HD_VISUAL_HUD    ║")
        print("╚════════════════════════════════════════════════════════════╝")
        
        while True:
            is_alive = await self.ping_check()
            if not is_alive:
                await self.force_activation()
            else:
                metrics = self.get_signal_metrics()
                active_iface = list(metrics.keys())[0] if metrics else "None"
                self.log_hud(f"Signal Nominal. Interface: {active_iface} | Status: 100%", "OK")
            
            await asyncio.sleep(10)

if __name__ == "__main__":
    ai_core = AdvancedNetAI()
    try:
        asyncio.run(ai_core.run_core())
    except KeyboardInterrupt:
        print("\n[HUD] AI Core Shutting Down.")
