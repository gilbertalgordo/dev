<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Google Nexus Wearable UI</title>
    <!-- Load Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Use Inter font family -->
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #0d0d10; /* Very dark background */
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            padding: 1rem;
        }
        #watch-screen {
            max-width: 360px; /* Simulating a typical watch screen size */
            width: 100%;
            min-height: 640px;
            background-color: #1a1a24; /* Dark component background */
            border-radius: 40px; /* Rounded watch bezel */
            box-shadow: 0 0 50px rgba(0, 255, 255, 0.1), 0 0 20px rgba(0, 0, 0, 0.5);
            padding: 1.5rem;
            color: #e0e0f0;
            overflow-y: auto;
            border: 4px solid rgba(13, 107, 137, 0.3);
            transition: all 0.3s ease;
        }
        .card {
            background-color: #242430;
            padding: 1rem;
            border-radius: 18px;
            margin-bottom: 1rem;
            border: 1px solid rgba(75, 85, 99, 0.3);
            transition: all 0.2s;
        }
        .card:hover {
            background-color: #2c2c38;
            border-color: #4a5568;
        }
        .icon {
            color: #00e6ff; /* Cyan accent color */
            font-size: 1.5rem;
        }
        .text-primary {
            color: #00e6ff;
        }
        /* Custom scrollbar for better aesthetics */
        #watch-screen::-webkit-scrollbar {
            width: 4px;
        }
        #watch-screen::-webkit-scrollbar-thumb {
            background: #00e6ff;
            border-radius: 2px;
        }
        /* Icon styles for simplicity (using placeholders/emojis as a fallback to external libraries) */
        .feature-icon {
            display: inline-block;
            font-size: 1.5rem;
            width: 2rem;
            text-align: center;
            vertical-align: middle;
        }
    </style>
    <!-- Necessary for the Google Services Emulation -->
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { getAuth, signInAnonymously, signInWithCustomToken } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
        import { getFirestore, setDoc, doc, collection, onSnapshot } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";

        // Global variables provided by the Canvas environment
        const appId = typeof __app_id !== 'undefined' ? __app_id : 'default-app-id';
        const firebaseConfig = typeof __firebase_config !== 'undefined' ? JSON.parse(__firebase_config) : null;
        const initialAuthToken = typeof __initial_auth_token !== 'undefined' ? __initial_auth_token : null;

        let db, auth;
        let currentUserId = 'initializing...';

        document.addEventListener('DOMContentLoaded', async () => {
            if (firebaseConfig) {
                try {
                    const app = initializeApp(firebaseConfig);
                    db = getFirestore(app);
                    auth = getAuth(app);
                    
                    if (initialAuthToken) {
                        await signInWithCustomToken(auth, initialAuthToken);
                    } else {
                        await signInAnonymously(auth);
                    }
                    
                    currentUserId = auth.currentUser?.uid || crypto.randomUUID();
                    document.getElementById('user-id').textContent = currentUserId;
                    
                    // Start real-time sync for Vitals data (simulated Ring input)
                    startVitalsSync();

                } catch (error) {
                    console.error("Firebase initialization or auth failed:", error);
                    document.getElementById('user-id').textContent = 'Error loading account';
                }
            } else {
                console.warn("Firebase config not found. Running in simulation mode only.");
                document.getElementById('user-id').textContent = 'SIM-USER-A4B3C2D1';
            }
        });

        function startVitalsSync() {
            if (!db || !auth.currentUser) return;
            
            // 10. Energy Generator/Vital Statistics/Heartbeat Tracker (Simulated data source: Ring)
            // Storing in private data space: /artifacts/{appId}/users/{userId}/vitals
            const vitalsRef = doc(db, 'artifacts', appId, 'users', auth.currentUser.uid, 'vitals', 'latest');
            
            // Listener for real-time updates (simulated input from the Ring device)
            onSnapshot(vitalsRef, (docSnap) => {
                if (docSnap.exists()) {
                    const data = docSnap.data();
                    document.getElementById('heart-rate').textContent = `${data.heartRate} bpm`;
                    document.getElementById('energy-level').textContent = `${data.energyLevel}%`;
                    document.getElementById('temp-body').textContent = `${data.bodyTemp}¬∞F`;
                    document.getElementById('sleep-state').textContent = data.sleepState;
                }
            }, (error) => {
                console.error("Error listening to vitals:", error);
            });

            // Simulate the Ring periodically generating data (updates Firestore every 5 seconds)
            setInterval(async () => {
                const now = new Date();
                const newHeartRate = 60 + Math.floor(Math.random() * 40); // 60-100 bpm
                const newEnergy = Math.min(100, 70 + Math.floor(Math.random() * 30)); // 70-100%
                const newBodyTemp = (97.5 + Math.random() * 2).toFixed(1); // 97.5-99.5 F
                
                const isSleeping = now.getHours() >= 23 || now.getHours() < 7;
                const sleepState = isSleeping ? 'Deep Sleep' : 'Active';

                try {
                    await setDoc(vitalsRef, {
                        heartRate: newHeartRate,
                        energyLevel: newEnergy,
                        bodyTemp: newBodyTemp,
                        sleepState: sleepState,
                        timestamp: now.toISOString()
                    }, { merge: true });
                } catch (e) {
                    console.error("Error setting vitals data:", e);
                }
            }, 5000); // Update every 5 seconds
        }

        // Global functions for the main script access
        window.getUserId = () => currentUserId;
        window.db = db;
        window.auth = auth;
    </script>
</head>
<body>

<div id="watch-screen" class="shadow-2xl">
    
    <!-- 3. Time and date with timezone -->
    <div class="text-center mb-6">
        <div id="current-time" class="text-6xl font-extrabold text-white">00:00</div>
        <div id="current-date" class="text-sm font-medium text-gray-400">Loading... | PDT</div>
    </div>

    <!-- VITAL STATS SUMMARY (From Ring Input) -->
    <div class="flex justify-around items-center mb-8">
        <!-- 10. Heartbeat Tracker -->
        <div class="text-center">
            <span class="feature-icon text-red-500">‚ù§Ô∏è</span>
            <div id="heart-rate" class="text-xl font-bold">-- bpm</div>
            <div class="text-xs text-gray-400">Heart Rate</div>
        </div>
        <!-- 10. Energy Generator (Level) -->
        <div class="text-center">
            <span class="feature-icon text-green-400">‚ö°</span>
            <div id="energy-level" class="text-xl font-bold">-- %</div>
            <div class="text-xs text-gray-400">Energy</div>
        </div>
        <!-- 6. Temperature (Body Temp from Ring) -->
        <div class="text-center">
            <span class="feature-icon text-orange-400">üî•</span>
            <div id="temp-body" class="text-xl font-bold">-- ¬∞F</div>
            <div class="text-xs text-gray-400">Body Temp</div>
        </div>
    </div>

    <div class="grid grid-cols-1 gap-3">
        
        <!-- 1. Track activity with sleep features -->
        <div class="card flex justify-between items-center">
            <div class="flex items-center">
                <span class="feature-icon mr-3">üèÉ</span>
                <div>
                    <div class="text-lg font-semibold">Activity & Sleep</div>
                    <div id="sleep-state" class="text-sm text-gray-400">Loading State...</div>
                </div>
            </div>
            <div class="text-primary text-2xl font-bold">9,812</div>
        </div>

        <!-- 2. GPS and tools with Google & iOS -->
        <div class="card flex justify-between items-center">
            <div class="flex items-center">
                <span class="feature-icon mr-3">üó∫Ô∏è</span>
                <div>
                    <div class="text-lg font-semibold">GPS & Tools</div>
                    <div class="text-sm text-gray-400">Google Maps | iOS Sync Active</div>
                </div>
            </div>
            <svg class="w-6 h-6 text-green-400" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m5.618-4.27a19.01 19.01 0 011.006 15.304C21.782 17.514 17.545 20 12 20c-5.546 0-9.782-2.486-10.624-5.966a19.01 19.01 0 011.006-15.304C2.218 6.486 6.455 4 12 4c5.546 0 9.782 2.486 10.624 5.966z"></path></svg>
        </div>

        <!-- 4. Calendar with task app. New Google app -->
        <div class="card">
            <div class="flex items-center mb-2">
                <span class="feature-icon mr-3">üìÖ</span>
                <div class="text-lg font-semibold">Today's Focus</div>
            </div>
            <ul class="text-sm space-y-1">
                <li class="flex justify-between text-gray-300">
                    <span>10:00 AM - Design Sync</span>
                    <span class="text-green-400">‚úì</span>
                </li>
                <li class="flex justify-between text-gray-300">
                    <span>1:30 PM - Task: Review Code</span>
                    <span class="text-yellow-400">...</span>
                </li>
            </ul>
        </div>
        
        <!-- 5. Weather disturbance tracking & 6. Ambient Temperature -->
        <div class="card flex justify-between items-center">
            <div class="flex items-center">
                <span class="feature-icon mr-3">‚õàÔ∏è</span>
                <div>
                    <div class="text-lg font-semibold">Weather Nexus</div>
                    <div class="text-sm text-red-400 font-bold">Storm Alert: Heavy Rain ETA 30m</div>
                </div>
            </div>
            <div id="temp-ambient" class="text-2xl font-bold">68¬∞F</div>
        </div>

        <!-- 7. Zone Scanning App -->
        <div class="card">
            <div class="flex items-center mb-2">
                <span class="feature-icon mr-3">üõ∞Ô∏è</span>
                <div class="text-lg font-semibold">Zone Scan App</div>
            </div>
            <button id="scan-button" class="w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-full text-sm transition-colors">
                Initiate Local Scan
            </button>
            <div id="scan-status" class="mt-2 text-center text-xs text-gray-400">Status: Standby. Safe Zone Detected.</div>
        </div>

        <!-- 8. Virtual AI Interaction -->
        <div class="card">
            <div class="flex items-center mb-2">
                <span class="feature-icon mr-3">üß†</span>
                <div class="text-lg font-semibold">AI Assistant (Gemini)</div>
            </div>
            <input type="text" id="ai-input" placeholder="Ask your watch..." class="w-full p-2 bg-gray-700 text-white rounded-lg text-sm mb-2 focus:ring focus:ring-blue-500 border-none">
            <div id="ai-response" class="text-xs text-gray-400 italic min-h-[20px]">
                "How can I assist you today? (Try: 'Check my run speed')"
            </div>
        </div>

        <!-- 9. Speedometer (Note: You listed 9 twice, combining into one card) -->
        <div class="card flex justify-between items-center">
            <div class="flex items-center">
                <span class="feature-icon mr-3">üöÄ</span>
                <div class="text-lg font-semibold">Speedometer</div>
            </div>
            <div id="speed-display" class="text-2xl font-extrabold text-primary">0.0 MPH</div>
        </div>
        
        <!-- 10. Google Account Management (using required globals for simulation) -->
        <div class="card">
            <div class="flex items-center mb-2">
                <span class="feature-icon mr-3">üë§</span>
                <div class="text-lg font-semibold">Google Account</div>
            </div>
            <div class="text-xs truncate">
                User ID: <span id="user-id" class="font-mono text-yellow-400">Loading...</span>
            </div>
            <div class="text-xs text-gray-400 mt-1">
                App ID: <span class="font-mono text-gray-500" id="app-id-display"></span>
            </div>
            <button class="w-full mt-3 bg-gray-700 hover:bg-gray-600 text-white font-bold py-1.5 px-4 rounded-full text-xs transition-colors">
                Manage Settings
            </button>
        </div>

    </div>
</div>

<script>
    document.addEventListener('DOMContentLoaded', () => {
        const timeDisplay = document.getElementById('current-time');
        const dateDisplay = document.getElementById('current-date');
        const aiInput = document.getElementById('ai-input');
        const aiResponse = document.getElementById('ai-response');
        const scanButton = document.getElementById('scan-button');
        const scanStatus = document.getElementById('scan-status');
        const speedDisplay = document.getElementById('speed-display');
        const appIdDisplay = document.getElementById('app-id-display');

        // Global variables provided by the Canvas environment (retrieved from module script)
        const appId = typeof __app_id !== 'undefined' ? __app_id : 'default-app-id';
        appIdDisplay.textContent = appId;

        // --- 3. Time and date with timezone ---
        function updateTime() {
            const now = new Date();
            const timeOptions = { hour: '2-digit', minute: '2-digit', hour12: true };
            const dateOptions = { weekday: 'short', month: 'short', day: 'numeric' };
            const timezone = now.toLocaleTimeString('en-us', { timeZoneName:'short' }).split(' ')[2];

            timeDisplay.textContent = now.toLocaleTimeString('en-US', timeOptions);
            dateDisplay.textContent = `${now.toLocaleDateString('en-US', dateOptions)} | ${timezone || 'GMT'}`;
        }
        setInterval(updateTime, 1000);
        updateTime(); // Initial call

        // --- 6. Ambient Temperature ---
        document.getElementById('temp-ambient').textContent = `${(60 + Math.floor(Math.random() * 20))}¬∞F`;

        // --- 7. Zone Scanning App interaction ---
        scanButton.addEventListener('click', () => {
            scanButton.disabled = true;
            scanButton.textContent = 'Scanning...';
            scanStatus.textContent = 'Searching for anomalies...';
            
            setTimeout(() => {
                const results = ['Anomalous Energy Signature Detected!', 'Local Area Clear.', 'Unknown Signal Interference.', 'Safe Zone Detected.'];
                const status = results[Math.floor(Math.random() * results.length)];
                
                scanStatus.textContent = `Status: ${status}`;
                scanButton.textContent = 'Initiate Local Scan';
                scanButton.disabled = false;
            }, 1500);
        });

        // --- 8. Virtual AI Interaction ---
        aiInput.addEventListener('keypress', (e) => {
            if (e.key === 'Enter' && aiInput.value.trim() !== '') {
                const query = aiInput.value.trim().toLowerCase();
                aiInput.value = '';
                aiResponse.innerHTML = `<span class="text-primary">Thinking...</span>`;

                // Simulate AI response delay
                setTimeout(() => {
                    let responseText = '';
                    if (query.includes('speed') || query.includes('run')) {
                        // Simulate interaction with 9. Speedometer/Activity
                        const speed = (Math.random() * 15).toFixed(1);
                        speedDisplay.textContent = `${speed} MPH`;
                        responseText = `Your current speed is logged at ${speed} MPH. Stay moving!`;
                    } else if (query.includes('heart') || query.includes('vitals')) {
                        // Simulate interaction with 10. Vitals
                        const hr = document.getElementById('heart-rate').textContent;
                        responseText = `Your last recorded heart rate is ${hr}. All vitals are within nominal range.`;
                    } else if (query.includes('weather')) {
                        // Simulate interaction with 5. Weather
                        responseText = `The Storm Alert is still active. Please seek shelter or plan routes accordingly.`;
                    } else {
                        responseText = `I've noted your query: "${query}". Please check the full Gemini app for detailed answers.`;
                    }
                    aiResponse.innerHTML = responseText;
                }, 1000);
            }
        });
    });

</script>
</body>
</html>

